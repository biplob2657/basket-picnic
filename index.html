<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶ù‡ßÅ‡ßú‡¶ø‡¶§‡ßá ‡¶¨‡¶≤ ‡¶®‡¶ø‡¶ï‡ßç‡¶∑‡ßá‡¶™ - ‡¶∏‡ßç‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #c0392b;
            --warning-color: #f39c12;
            --light-bg: #ecf0f1;
            --white: #ffffff;
            --text-color: #333;
            --sidebar-width: 250px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary-color);
            color: var(--white);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            text-align: center;
            background-color: var(--secondary-color);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .nav-links {
            list-style: none;
            padding-top: 20px;
            flex: 1;
        }

        .nav-links li {
            padding: 0;
        }

        .nav-links li a {
            display: block;
            padding: 15px 20px;
            color: #bdc3c7;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            cursor: pointer;
        }

        .nav-links li a:hover, .nav-links li a.active {
            background-color: var(--secondary-color);
            color: var(--white);
            border-left-color: var(--accent-color);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 20px;
            transition: margin-left 0.3s ease;
            width: 100%;
        }

        /* Mobile Toggle */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            right: 15px;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1100;
            font-size: 1.2rem;
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }

        .section-title {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-bg);
            color: var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        /* Search Bar */
        .search-container {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 10px;
            margin-bottom: 20px;
            background: var(--white);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 0.85rem;
            margin-bottom: 5px;
            color: #7f8c8d;
        }

        .form-group input, .form-group select {
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            background: white;
        }

        .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            text-align: center;
            font-size: 0.9rem;
            margin-right: 5px;
            margin-bottom: 5px;
            display: inline-block;
        }

        .btn-primary { background: var(--accent-color); color: white; }
        .btn-primary:hover { background: #2980b9; }

        .btn-success { background: var(--success-color); color: white; }
        .btn-success:hover { background: #219150; }

        .btn-danger { background: var(--danger-color); color: white; }
        .btn-danger:hover { background: #a93226; }

        .btn-warning { background: var(--warning-color); color: white; }
        
        .btn-gold { background: #f1c40f; color: #000; }
        .btn-silver { background: #95a5a6; color: #fff; }
        .btn-bronze { background: #cd7f32; color: #fff; }

        /* Tables */
        .table-responsive {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            white-space: nowrap;
        }

        thead {
            background-color: var(--primary-color);
            color: white;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        tr:hover {
            background-color: #f9f9f9;
        }

        /* Status Badges */
        .badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            display: inline-block;
        }
        .badge-1st { background: #f1c40f; color: #000; }
        .badge-2nd { background: #bdc3c7; color: #000; }
        .badge-3rd { background: #cd7f32; color: #fff; }
        
        .final-banner {
            background-color: #e8f8f5;
            color: #27ae60;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #27ae60;
            text-align: center;
            font-weight: bold;
        }

        /* Winner Display */
        .winner-podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            margin-top: 30px;
            height: 200px;
        }
        .podium-place {
            width: 80px;
            background: #bdc3c7;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 5px 5px 0 0;
            color: white;
            font-weight: bold;
        }
        .place-1 { height: 180px; background: #f1c40f; color: #000; }
        .place-2 { height: 120px; background: #95a5a6; }
        .place-3 { height: 80px; background: #cd7f32; }
        
        .podium-name {
            margin-top: 10px;
            font-size: 0.9rem;
            text-align: center;
            max-width: 100px;
            word-wrap: break-word;
        }

        /* Toast Notification */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 2000;
        }

        .toast {
            background-color: #333;
            color: #fff;
            padding: 12px 24px;
            border-radius: 4px;
            margin-top: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            animation: slideIn 0.3s ease-out;
        }

        .toast.success { border-left: 5px solid var(--success-color); }
        .toast.error { border-left: 5px solid var(--danger-color); }
        .toast.info { border-left: 5px solid var(--accent-color); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
            }
            .menu-toggle {
                display: block;
            }
            .search-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <!-- Toast Notification Container -->
    <div id="toast-container"></div>

    <!-- Mobile Menu Toggle -->
    <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞ ‡¶Æ‡ßá‡¶®‡ßÅ</button>

    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>‡¶ù‡ßÅ‡ßú‡¶ø‡¶§‡ßá ‡¶¨‡¶≤ ‡¶®‡¶ø‡¶ï‡ßç‡¶∑‡ßá‡¶™</h2>
            <p>‡¶∏‡ßç‡¶™‡ßã‡¶∞‡ßç‡¶ü‡¶∏ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</p>
        </div>
        <ul class="nav-links">
            <li><a onclick="showSection('list')" id="nav-list" class="active">üìã ‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</a></li>
            <li><a onclick="showSection('round1')" id="nav-round1">ü•ä ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ßß</a></li>
            <li><a onclick="showSection('round2')" id="nav-round2">ü•ä ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß®</a></li>
            <li><a onclick="showSection('round3')" id="nav-round3">ü•ä ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß©</a></li>
            <li><a onclick="showSection('round4')" id="nav-round4">ü•ä ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß™</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- SECTION: Player List (Master Data) -->
        <section id="list" class="section active">
            <div class="card">
                <div class="section-title">
                    <h3>‡¶∏‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
                    <span class="badge" style="background:#ddd; color:#333">Total: <span id="total-count">0</span></span>
                </div>
                
                <div class="search-container">
                    <div class="form-group">
                        <label>Employee ID</label>
                        <input type="text" id="search-id" placeholder="‡¶Ü‡¶á‡¶°‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." onkeyup="filterMasterList()">
                    </div>
                    <div class="form-group">
                        <label>Department</label>
                        <!-- Dropdown for Department -->
                        <select id="search-dept" onchange="filterMasterList()">
                            <option value="">‡¶∏‡¶ï‡¶≤ ‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó (All)</option>
                            <!-- Options will be populated by JS -->
                        </select>
                    </div>
                    <div class="form-group" style="justify-content: flex-end;">
                         <button class="btn btn-primary" onclick="filterMasterList()">‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                </div>

                <div class="table-responsive">
                    <table id="master-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡¶®‡¶æ‡¶Æ</th>
                                <th>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</th>
                                <th>‡¶™‡¶¶‡¶¨‡ßÄ</th>
                                <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                            </tr>
                        </thead>
                        <tbody id="master-table-body">
                            <!-- Data will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- SECTION: Round 1 -->
        <section id="round1" class="section">
            <div class="card">
                <div class="section-title">
                    <h3>‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ßß - ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡ßÄ</h3>
                    <button class="btn btn-primary" onclick="resetRound(1)">Reset Round</button>
                </div>
                <div id="r1-final-banner" class="final-banner" style="display:none;">üèÜ ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°: ‡¶¨‡¶ø‡¶ú‡ßü‡ßÄ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                <div class="table-responsive">
                    <table id="r1-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡¶®‡¶æ‡¶Æ</th>
                                <th>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</th>
                                <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                            </tr>
                        </thead>
                        <tbody id="r1-table-body">
                            <!-- Round 1 Players -->
                        </tbody>
                    </table>
                </div>
                <p style="margin-top:10px; color:#777; font-size:0.9rem;">* ‡¶Ø‡¶¶‡¶ø ‡ß© ‡¶ú‡¶®‡ßá‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡ßá, "‡¶ú‡ßü" ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡•§ ‡ß© ‡¶ú‡¶® ‡¶¨‡¶æ ‡¶§‡¶æ‡¶∞ ‡¶ï‡¶Æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡ßß‡¶Æ/‡ß®‡ßü/‡ß©‡ßü ‡¶¨‡¶æ‡¶õ‡¶æ‡¶á ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            </div>
        </section>

        <!-- SECTION: Round 2 -->
        <section id="round2" class="section">
            <div class="card">
                <div class="section-title">
                    <h3>‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß® - ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡ßÄ</h3>
                    <button class="btn btn-primary" onclick="resetRound(2)">Reset Round</button>
                </div>
                <div id="r2-final-banner" class="final-banner" style="display:none;">üèÜ ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°: ‡¶¨‡¶ø‡¶ú‡ßü‡ßÄ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                <div class="table-responsive">
                    <table id="r2-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡¶®‡¶æ‡¶Æ</th>
                                <th>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</th>
                                <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                            </tr>
                        </thead>
                        <tbody id="r2-table-body">
                            <!-- Round 2 Players -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- SECTION: Round 3 -->
        <section id="round3" class="section">
            <div class="card">
                <div class="section-title">
                    <h3>‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß© - ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡ßÄ</h3>
                    <button class="btn btn-primary" onclick="resetRound(3)">Reset Round</button>
                </div>
                <div id="r3-final-banner" class="final-banner" style="display:none;">üèÜ ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°: ‡¶¨‡¶ø‡¶ú‡ßü‡ßÄ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                <div class="table-responsive">
                    <table id="r3-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡¶®‡¶æ‡¶Æ</th>
                                <th>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</th>
                                <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                            </tr>
                        </thead>
                        <tbody id="r3-table-body">
                            <!-- Round 3 Players -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- SECTION: Round 4 -->
        <section id="round4" class="section">
            <div class="card">
                <div class="section-title">
                    <h3>‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ß™ - ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡ßÄ</h3>
                    <button class="btn btn-primary" onclick="resetRound(4)">Reset Round</button>
                </div>
                <div id="r4-final-banner" class="final-banner" style="display:none;">üèÜ ‡¶´‡¶æ‡¶á‡¶®‡¶æ‡¶≤ ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°: ‡¶¨‡¶ø‡¶ú‡ßü‡ßÄ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                <div class="table-responsive">
                    <table id="r4-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>‡¶®‡¶æ‡¶Æ</th>
                                <th>‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó</th>
                                <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
                            </tr>
                        </thead>
                        <tbody id="r4-table-body">
                            <!-- Round 4 Players -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- GLOBAL WINNER DISPLAY SECTION (Will show if winners selected) -->
        <section id="result" class="section">
             <div class="card" id="winner-display-card" style="display:none; text-align:center;">
                <h3>üèÜ ‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ üèÜ</h3>
                <div class="winner-podium">
                    <div class="podium-place place-2">
                        <span>2nd</span>
                    </div>
                    <div class="podium-place place-1">
                        <span>1st</span>
                    </div>
                    <div class="podium-place place-3">
                        <span>3rd</span>
                    </div>
                </div>
                <div class="winner-podium" style="height: auto; align-items: flex-start;">
                    <div class="podium-name" id="name-2nd">-</div>
                    <div class="podium-name" id="name-1st">-</div>
                    <div class="podium-name" id="name-3rd">-</div>
                </div>
                <button class="btn btn-danger" style="margin-top:20px;" onclick="resetAll()">‡¶®‡¶§‡ßÅ‡¶® ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </section>

    </main>

    <script>
        // --- DATA ---
        const rawEmployees = [
            { id: 21814, name: "Md.Najimul Islam", dept: "Paper Covering", desg: "Helper" },
            { id: 20340, name: "Md.Ashraful islam", dept: "Techl-Cell", desg: "Lab.Assistant" },
            { id: 21483, name: "Forhat Hossain", dept: "Wire Drawing", desg: "Helper" },
            { id: 21474, name: "Md. Sakib", dept: "Wire Drawing", desg: "Helper" },
            { id: 21412, name: "Md. Uzzal Mia", dept: "Wire Drawing", desg: "Jr.Operator" },
            { id: 221104, name: "Md. Jahidul Islam Jihad", dept: "BUN/STD", desg: "Helper" },
            { id: 213117, name: "Md. Minal Mia", dept: "Coiling", desg: "Helper" },
            { id: 211119, name: "Md. Nurol Islam", dept: "Coiling", desg: "Helper" },
            { id: 20438, name: "Md. Golam Mustofa", dept: "Logistic", desg: "Supervisor" },
            { id: 20497, name: "Md. Emon Hossain", dept: "Logistic", desg: "Helper" },
            { id: 20419, name: "MD. IMRAN KHAN", dept: "Logistic", desg: "Sr.Executive" },
            { id: 20468, name: "Md. Aynul Mia", dept: "Logistic", desg: "Helper" },
            { id: 20488, name: "Md. Mojahid Ali", dept: "Logistic", desg: "Helper" },
            { id: 20403, name: "Md. Mahamud Hassan", dept: "Logistic", desg: "Operator" },
            { id: 21117, name: "Md. Hafizul Rahman", dept: "Enamel", desg: "Jr.Operator" },
            { id: 20108, name: "Mohammad Alamgir Hossain", dept: "HR & Admin", desg: "Asstt. Manager" },
            { id: 21218, name: "Md.Faridul Islam", dept: "Insulation", desg: "Jr.Operator" },
            { id: 21363, name: "Md. Sabbir Mia", dept: "Insulation", desg: "Skill Helper" },
            { id: 21273, name: "Md. Sohag Mia", dept: "Insulation", desg: "Helper" },
            { id: 21666, name: "Md. Shaon Islam", dept: "Sheathing", desg: "Helper" },
            { id: 22197, name: "Md. Rakib Mia", dept: "BUN/STD", desg: "Helper" },
            { id: 21236, name: "Md. Shakhaoat Hossain Soman (Nazmul Huda)", dept: "Insulation", desg: "Sr.Helper" },
            { id: 21759, name: "Md. Raton Mia", dept: "Upcast", desg: "Helper" },
            { id: 22159, name: "Shafiullah", dept: "BUN/STD", desg: "Helper" },
            { id: 22161, name: "Md.Tariqul Islam", dept: "BUN/STD", desg: "Skill Helper" },
            { id: 220142, name: "Md. Al-Amin", dept: "Transport", desg: "Forklift Driver" },
            { id: 21399, name: "Rasel Hossain (Ovi)", dept: "BUN/STD", desg: "Helper" },
            { id: 22195, name: "Md. Siyam", dept: "BUN/STD", desg: "Helper" },
            { id: 221110, name: "Md. Shahinur Islam", dept: "BUN/STD", desg: "Helper" },
            { id: 21457, name: "Md. Monjur Talukder", dept: "Wire Drawing", desg: "Helper" },
            { id: 21460, name: "Gowtom Chandra Bormon", dept: "Wire Drawing", desg: "Helper" },
            { id: 21481, name: "Md. Mantajul Islam", dept: "Wire Drawing", desg: "Helper" },
            { id: 21109, name: "Md. Kashem", dept: "Enamel", desg: "Operator" },
            { id: 21672, name: "Nayon Molla", dept: "Sheathing", desg: "Helper" },
            { id: 21416, name: "MD. SIRAZUL ISLAM", dept: "Wire Drawing", desg: "Jr.Operator" },
            { id: 21667, name: "Ajmir Hasan", dept: "Sheathing", desg: "Helper" },
            { id: 22186, name: "Md. Josim Uddin", dept: "BUN/STD", desg: "Semi Operator" },
            { id: 21722, name: "Md. Tajul Islam", dept: "Upcast", desg: "Jr.Operator" },
            { id: 21770, name: "Md. Rayhan Mia", dept: "Upcast", desg: "Helper" },
            { id: 21644, name: "Md. Jonayet Mia", dept: "Sheathing", desg: "Helper" },
            { id: 22198, name: "Ali", dept: "BUN/STD", desg: "Helper" },
            { id: 221107, name: "Bijoy Majumdar", dept: "BUN/STD", desg: "Helper" },
            { id: 213110, name: "Md. Arman", dept: "Coiling", desg: "Helper" },
            { id: 213123, name: "Ariful Islam", dept: "Coiling", desg: "Helper" },
            { id: 213125, name: "Md. Jaber Hossain", dept: "Coiling", desg: "Helper" },
            { id: 20810, name: "Md. Akter Hossain", dept: "Maintenance", desg: "Fitter" },
            { id: 20809, name: "Md. Rahamat Ali", dept: "Maintenance", desg: "Generator Opt" },
            { id: 22151, name: "Md.Apel Mia (Latif Sarker)", dept: "Wire Drawing", desg: "Skill Helper" },
            { id: 21436, name: "Md. Sayful Islam", dept: "Wire Drawing", desg: "Sr.Helper" },
            { id: 20487, name: "Allil Ahmed", dept: "General", desg: "Helper" },
            { id: 20346, name: "Md.Saidur Rahman", dept: "Techl-Cell", desg: "Lab.Assistant" },
            { id: 20362, name: "Palash", dept: "Techl-Cell", desg: "Lab. Assistant" },
            { id: 20338, name: "Mehedi Hassan (Shanto)", dept: "Techl-Cell", desg: "Lab.Assistant" },
            { id: 20363, name: "Md. Naeem", dept: "Techl-Cell", desg: "Lab. Assistant" },
            { id: 20325, name: "Md. Shoruar Jahan", dept: "Techl-Cell", desg: "Executive" },
            { id: 20326, name: "Md. Helal Uddin", dept: "Techl-Cell", desg: "Sr.Lab.Asst." },
            { id: 20364, name: "Md. Jihad Khandokar", dept: "Techl-Cell", desg: "Lab. Assistant" },
            { id: 20311, name: "Robi Jyoti Chakma", dept: "Techl-Cell", desg: "Sr.Lab.Asst." },
            { id: 20365, name: "Kawsar Ahmed", dept: "Techl-Cell", desg: "Lab. Assistant" },
            { id: 20313, name: "Md. Ariful Islam", dept: "Techl-Cell", desg: "Asstt. Manager" },
            { id: 221114, name: "Md. Marajul Islam", dept: "BUN/STD", desg: "Helper" },
            { id: 21232, name: "Eleas Talukdar", dept: "Insulation", desg: "Skill Helper" },
            { id: 21269, name: "Shimon Baroi", dept: "Insulation", desg: "Helper" },
            { id: 21274, name: "Md. Hafizul Islam Sabbir", dept: "Insulation", desg: "Helper" },
            { id: 20513, name: "Md. Nazmul Alom", dept: "Operation", desg: "Jr.Executive" },
            { id: 21735, name: "Md. Ibrahim Hossain", dept: "Upcast", desg: "Jr.Operator" },
            { id: 21725, name: "Md. Younus Mia", dept: "Upcast", desg: "Sr.Helper" },
            { id: 21737, name: "Shree Folbabu Kumar", dept: "Upcast", desg: "Jr.Operator" },
            { id: 21746, name: "Loknath Biswas", dept: "Upcast", desg: "Helper" },
            { id: 21747, name: "Md. Saju", dept: "Upcast", desg: "Helper" },
            { id: 21760, name: "Md. Akash", dept: "Upcast", desg: "Helper" },
            { id: 21503, name: "Mohammad Abdullah Kawsar Hakim", dept: "Store", desg: "Sr.Executive" },
            { id: 21505, name: "Md.Sanaul Haque", dept: "Store", desg: "Jr.Executive" },
            { id: 21506, name: "Md.Mustak Ahmmed", dept: "Store", desg: "Jr.Executive" },
            { id: 20815, name: "Mohammad Yasin Arafat", dept: "Maintenance", desg: "Electrician" },
            { id: 21419, name: "Md. Mominul Islam", dept: "Wire Drawing", desg: "Jr.Operator" },
            { id: 20812, name: "Rahmotullah", dept: "Maintenance", desg: "Generator Opt" },
            { id: 220113, name: "Rony Lal", dept: "General", desg: "Sweeper" },
            { id: 220148, name: "Md. Sumon Mia", dept: "General", desg: "Helper" },
            { id: 20499, name: "Istiak Hossan", dept: "Logistic", desg: "Jr.Executive" },
            { id: 20803, name: "Seddekur Rahman", dept: "Maintenance", desg: "Supervisor" },
            { id: 20805, name: "Md.Farhad Hosain", dept: "Maintenance", desg: "Supervisor" },
            { id: 20807, name: "Suman Chandra Das", dept: "Maintenance", desg: "Fitter" },
            { id: 20814, name: "Abu Jafar Mohammed Shaleh", dept: "Maintenance", desg: "Technician" },
            { id: 20816, name: "Nazrul Islam", dept: "Maintenance", desg: "Sr.Electrician" },
            { id: 20817, name: "Osman Gani", dept: "Maintenance", desg: "Forman" },
            { id: 20825, name: "Md. Razu Ahmed", dept: "Maintenance", desg: "Fitter" },
            { id: 21802, name: "Md. Baccu Miah", dept: "Paper Covering", desg: "Sr.Operator" },
            { id: 21665, name: "Sifat Ahmed", dept: "Sheathing", desg: "Helper" },
            { id: 21668, name: "Abu Hena Md. Nayem", dept: "Sheathing", desg: "Helper" },
            { id: 21671, name: "Md. Anamul Hossain", dept: "Sheathing", desg: "Helper" },
            { id: 21417, name: "Md. Asadul Hoque", dept: "Wire Drawing", desg: "Skill Helper" },
            { id: 22208, name: "Md. Asifur Rahman", dept: "Extrusion", desg: "Helper" },
            { id: 21404, name: "Md. Nur Alom", dept: "Wire Drawing", desg: "Operator" }
        ];

        // --- STATE MANAGEMENT ---
        let appState = {
            round1: [],
            round2: [],
            round3: [],
            round4: [],
            winners: { 1: null, 2: null, 3: null }
        };

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            renderMasterTable(rawEmployees);
            document.getElementById('total-count').innerText = rawEmployees.length;
            populateDepartmentDropdown();
        });

        // --- DEPARTMENT DROPDOWN ---
        function populateDepartmentDropdown() {
            const depts = [...new Set(rawEmployees.map(e => e.dept))].sort();
            const select = document.getElementById('search-dept');
            depts.forEach(dept => {
                const option = document.createElement('option');
                option.value = dept;
                option.innerText = dept;
                select.appendChild(option);
            });
        }

        // --- NAVIGATION ---
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));

            document.getElementById(sectionId).classList.add('active');
            document.getElementById('nav-' + sectionId).classList.add('active');

            // Close sidebar on mobile
            document.getElementById('sidebar').classList.remove('open');

            // Refresh specific sections
            if(sectionId.startsWith('round')) {
                const rNum = parseInt(sectionId.replace('round', ''));
                renderRoundTable(rNum);
            }
            
            // Show Result Section if winners exist
            if(sectionId === 'result') {
                checkResults();
            }
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // --- PLAYER LIST (MASTER) LOGIC ---
        function renderMasterTable(data) {
            const tbody = document.getElementById('master-table-body');
            tbody.innerHTML = '';
            
            data.forEach(emp => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${emp.id}</td>
                    <td>${emp.name}</td>
                    <td>${emp.dept}</td>
                    <td>${emp.desg}</td>
                    <td>
                        <button class="btn btn-primary" onclick="addToRound1(${emp.id})">Select for R1</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function filterMasterList() {
            const idVal = document.getElementById('search-id').value.toLowerCase();
            const deptVal = document.getElementById('search-dept').value;

            const filtered = rawEmployees.filter(emp => {
                const matchId = String(emp.id).includes(idVal);
                const matchDept = deptVal === "" || emp.dept === deptVal;
                return matchId && matchDept;
            });

            renderMasterTable(filtered);
        }

        function addToRound1(id) {
            if (appState.round1.find(p => p.id === id)) {
                showToast('‡¶è‡¶á ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡¶ü‡¶ø ‡¶Ü‡¶ó‡ßá ‡¶•‡ßá‡¶ï‡ßá‡¶á ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ßß ‡¶è ‡¶Ü‡¶õ‡ßá!', 'error');
                return;
            }

            const emp = rawEmployees.find(e => e.id === id);
            if (emp) {
                appState.round1.push(emp);
                showToast(`${emp.name} ‡¶ï‡ßá ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡ßß ‡¶è ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`, 'success');
            }
        }

        // --- ROUND LOGIC (DYNAMIC FINAL) ---
        function renderRoundTable(round) {
            const tbody = document.getElementById(`r${round}-table-body`);
            const banner = document.getElementById(`r${round}-final-banner`);
            tbody.innerHTML = '';

            const players = appState[`round${round}`];
            const isFinalStage = players.length <= 3; // Logic: If 3 or less, it's Final

            if (isFinalStage) {
                banner.style.display = 'block';
            } else {
                banner.style.display = 'none';
            }

            if (players.length === 0) {
                tbody.innerHTML = `<tr><td colspan="4" style="text-align:center; padding:20px;">‡¶ï‡ßã‡¶®‡ßã ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Ø‡ßã‡¶ó‡ßÄ ‡¶®‡ßá‡¶á</td></tr>`;
                return;
            }

            players.forEach(player => {
                const tr = document.createElement('tr');
                let actionButtons = '';

                if (isFinalStage) {
                    // Final Stage Buttons
                    actionButtons = `
                        <button class="btn btn-gold" onclick="setWinner(${player.id}, 1, ${round})">‡ßß‡¶Æ</button>
                        <button class="btn btn-silver" onclick="setWinner(${player.id}, 2, ${round})">‡ß®‡ßü</button>
                        <button class="btn btn-bronze" onclick="setWinner(${player.id}, 3, ${round})">‡ß©‡ßü</button>
                    `;
                } else {
                    // Normal Round Buttons
                    actionButtons = `
                        <button class="btn btn-success" onclick="winRound(${player.id}, ${round})">‡¶ú‡ßü (Next R${round+1})</button>
                        <button class="btn btn-danger" onclick="loseRound(${player.id}, ${round})">‡¶¨‡¶æ‡¶¶</button>
                    `;
                }

                tr.innerHTML = `
                    <td>${player.id}</td>
                    <td>${player.name} ${getWinnerBadge(player.id)}</td>
                    <td>${player.dept}</td>
                    <td>${actionButtons}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function getWinnerBadge(pid) {
            if(appState.winners[1] && appState.winners[1].id === pid) return '<span class="badge badge-1st">1st</span>';
            if(appState.winners[2] && appState.winners[2].id === pid) return '<span class="badge badge-2nd">2nd</span>';
            if(appState.winners[3] && appState.winners[3].id === pid) return '<span class="badge badge-3rd">3rd</span>';
            return '';
        }

        function winRound(id, currentRound) {
            const playerIndex = appState[`round${currentRound}`].findIndex(p => p.id === id);
            if (playerIndex === -1) return;

            const player = appState[`round${currentRound}`][playerIndex];
            
            // Move to next round
            const nextRound = currentRound + 1;
            if(nextRound <= 4) { // Max round limit hardcoded as 4 for simplicity
                appState[`round${nextRound}`].push(player);
            }
            
            // Remove from current round
            appState[`round${currentRound}`].splice(playerIndex, 1);

            showToast(`${player.name} ‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ${nextRound} ‡¶è ‡¶â‡¶§‡ßç‡¶§‡ßÄ‡¶∞‡ßç‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá!`, 'success');
            renderRoundTable(currentRound);
        }

        function loseRound(id, currentRound) {
            const playerIndex = appState[`round${currentRound}`].findIndex(p => p.id === id);
            if (playerIndex === -1) return;

            const player = appState[`round${currentRound}`][playerIndex];
            appState[`round${currentRound}`].splice(playerIndex, 1);

            showToast(`${player.name} ‡¶ï‡ßá ‡¶¨‡¶æ‡¶¶ ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`, 'info');
            renderRoundTable(currentRound);
        }

        function setWinner(id, position, roundNum) {
            const player = appState[`round${roundNum}`].find(p => p.id === id);
            
            if (!appState.winners[position] || confirm('‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ú‡¶® ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ü‡¶õ‡ßá‡•§ ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
                appState.winners[position] = player;
                showToast(`${player.name} ‡¶ï‡ßá ${position} ‡¶¨‡¶ø‡¶ú‡ßü‡ßÄ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`, 'success');
                renderRoundTable(roundNum); // Refresh badges
                
                // Auto navigate to result if all 3 picked
                if(appState.winners[1] && appState.winners[2] && appState.winners[3]) {
                    // Optional: showSection('result');
                    checkResults();
                }
            }
        }

        function checkResults() {
            const w1 = appState.winners[1];
            const w2 = appState.winners[2];
            const w3 = appState.winners[3];

            const displayCard = document.getElementById('winner-display-card');
            const resultSection = document.getElementById('result');

            if (w1 || w2 || w3) {
                // Add Result to Sidebar if not present
                let resultLink = document.getElementById('nav-result');
                if(!resultLink) {
                   const ul = document.querySelector('.nav-links');
                   const li = document.createElement('li');
                   li.innerHTML = '<a onclick="showSection(\'result\')" id="nav-result" style="background:#27ae60; color:white;">üèÜ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤</a>';
                   ul.appendChild(li);
                }

                displayCard.style.display = 'block';
                resultSection.style.display = 'block';
                document.getElementById('name-1st').innerText = w1 ? w1.name : '-';
                document.getElementById('name-2nd').innerText = w2 ? w2.name : '-';
                document.getElementById('name-3rd').innerText = w3 ? w3.name : '-';
            }
        }

        function resetRound(round) {
            if(confirm(`‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ${round} ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?`)) {
                appState[`round${round}`] = [];
                renderRoundTable(round);
                showToast(`‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ${round} ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`, 'info');
            }
        }

        function resetAll() {
            if(confirm("‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ñ‡ßá‡¶≤‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶¨‡ßá‡¶®?")) {
                appState = {
                    round1: [], round2: [], round3: [], round4: [],
                    winners: { 1: null, 2: null, 3: null }
                };
                // Remove result link
                const resultLink = document.getElementById('nav-result');
                if(resultLink) resultLink.parentElement.remove();
                
                document.getElementById('winner-display-card').style.display = 'none';
                document.getElementById('result').style.display = 'none';
                
                showSection('list');
                showToast("‡¶®‡¶§‡ßÅ‡¶® ‡¶ñ‡ßá‡¶≤‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§", 'success');
            }
        }

        // --- UTILS ---
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerText = message;
            
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>